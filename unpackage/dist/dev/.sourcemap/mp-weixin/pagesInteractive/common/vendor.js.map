{"version":3,"sources":["uni-app:///pagesInteractive/dataUpdate.js"],"names":["__listDataAddHandle","list","map","forEach","item","get","id","delete","set","__dataUpdate","getNewsInfo","options","$http","request","url","method","data","dynamicId","noToken","result","newsDetail","currentTarget","$forceUpdate","setTimeout","ifLoaddingShow","getNewComment","getNew","currentPageNum","totalPage","loadStatus","pageNum","pageSize","parmas","code","dataTotalNum","total","call","newsCommentList","getNewsMapData","values","scrollToBottom","delay","deleteComment"],"mappings":"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","file":"pagesInteractive/common/vendor.js","sourcesContent":["// 加载数据\r\nconst __listDataAddHandle = function(list, map) {\r\n\t// 请求新数据时清空列表\r\n\tlist.forEach(item => {\r\n\t\t// 判断数据是否存在\r\n\t\tmap.get(item.id) ?  map.delete(item.id) : null;\r\n\t\tmap.set(item.id, item)\r\n\t}) \r\n}\t\r\n\r\nexport const __dataUpdate = {\r\n\t// 查询动态信息\r\n\tasync getNewsInfo(options) {\r\n\t\tconst data = await this.$http.request({\r\n\t\t\turl: '/dynamicState/selectDynamicDetail',\r\n\t\t\tmethod: 'POST',\r\n\t\t\tdata: {\r\n\t\t\t\tdynamicId: options.id\r\n\t\t\t},\r\n\t\t\tnoToken: options.noToken\r\n\t\t});\r\n\t\tconst result = data.data.data;\r\n\t\tthis.newsDetail = result;\r\n\t\tthis.currentTarget = result;\r\n\t\tthis.$forceUpdate();\r\n\t\tsetTimeout(() => {\r\n\t\t\tthis.ifLoaddingShow = false;\r\n\t\t}, 800);\r\n\t},\r\n\t// 查询动态评论\r\n\tasync getNewComment(options) {\r\n\t\t\r\n\t\tif (options.getNew) {\r\n\t\t\tthis.currentPageNum = this.totalPage ? this.totalPage : 1; \r\n\t\t}\r\n\t\t\r\n\t\tif ((this.currentPageNum > this.totalPage) && !options.getNew) {\r\n\t\t\tthis.loadStatus = 'nomore';\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tthis.loadStatus = 'loading';\r\n\t\tconst data = await this.$http.request({\r\n\t\t\turl: '/dynamicComment/selectCommentByDyIdAndPage',\r\n\t\t\tmethod: 'POST',\r\n\t\t\tdata: {\r\n\t\t\t\tpageNum: this.currentPageNum,\r\n\t\t\t\tpageSize: 10,\r\n\t\t\t\tparmas: {\r\n\t\t\t\t\tdynamicId: options.id\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tnoToken: options.noToken\r\n\t\t});\r\n\t\t\r\n\t\tconst result = data.data.data;\r\n\t\tif (data.data.code === 200) {\r\n\t\t\tthis.currentPageNum++;\r\n\t\t\tthis.totalPage = result.totalPage;\r\n\t\t\tthis.dataTotalNum = result.total;\r\n\t\t}\r\n\t\tthis.loadStatus = 'loadmore';\r\n\t\tif (this.totalPage === 0 || options.getNew || this.dataTotalNum < 10) {\r\n\t\t\tthis.loadStatus = 'nomore';\r\n\t\t}\r\n\r\n\t\t__listDataAddHandle.call(this, result.list, this.newsCommentList);\r\n\t},\r\n\t// 映射动态数据\r\n\tgetNewsMapData() {\r\n\t\tif (this.newsCommentList) {\r\n\t\t\treturn [...this.newsCommentList.values()];\r\n\t\t}\r\n\t},\r\n\t// 请求更新数据\r\n\tscrollToBottom() {\r\n\t\tthis.getNewComment({ id: this.newsDetail.id, noToken: true, delay: 100});\r\n\t},\r\n\t// 删除某条回复\r\n\tdeleteComment(id) {\r\n\t\tthis.newsCommentList.delete(id);\r\n\t\tthis.$forceUpdate();\r\n\t}\r\n}"],"sourceRoot":""}